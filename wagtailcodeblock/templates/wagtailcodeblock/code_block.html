{% load static wagtailcodeblock_tags %}
{% spaceless %}
    {# This is ugly, as it'll inject this code for each block, but browsers are smart enough to not load each time. #}
    {% load_prism_css %}
    {% load_prism_js %}
    {# <script src="{% static 'wagtailcodeblock/js/prism.min.js' %}" type='text/javascript'></script> #}
    {% for key, val in self.items %}
        {% if key == "language" %}



            <script src="//cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/components/prism-python.min.js"></script>
            <script src="//cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/components/prism-{{ val|stringformat:'s' }}.min.js"></script>
            <!-- XXXXXXX{{ val }}XXXXXX YYYY{{ val|safe }}YYY -->



            <script>
                language_class_name = 'language-{{ val }}';
            </script>
        {% endif %}
        {% if key == "code" %}
            <pre class="line-numbers">
                <code id="target-element-current">{{ val }}</code>
            </pre>
            <script>
                var block_num = (typeof block_num === 'undefined') ? 0 : block_num;
                block_num++;
                document.getElementById('target-element-current').className = language_class_name;
                document.getElementById('target-element-current').id = 'target-element-' + block_num;
            </script>
        {% endif %}
    {% endfor %}
{% endspaceless %}
